<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Adafruit LPD8806 LED Strip Library: Adafruit LPD8806 Library</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Adafruit LPD8806 LED Strip Library
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Adafruit <a class="el" href="class_l_p_d8806.html" title="Class that stores state and functions for interacting with LPD8806 LED strips. ">LPD8806</a> Library </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="intro_sec"></a>
Introduction</h1>
<p>Arduino library to control LPD8806-based RGB LED Strips</p>
<p>Clearing up some misconceptions about how the <a class="el" href="class_l_p_d8806.html" title="Class that stores state and functions for interacting with LPD8806 LED strips. ">LPD8806</a> drivers work:</p>
<p>The <a class="el" href="class_l_p_d8806.html" title="Class that stores state and functions for interacting with LPD8806 LED strips. ">LPD8806</a> is not a FIFO shift register. The first data out controls the LED <em>closest</em> to the processor (unlike a typical shift register, where the first data out winds up at the <em>furthest</em> LED). Each LED driver 'fills up' with data and then passes through all subsequent bytes until a latch condition takes place. This is actually pretty common among LED drivers.</p>
<p>All color data bytes have the high bit (128) set, with the remaining seven bits containing a brightness value (0-127). A byte with the high bit clear has special meaning (explained later).</p>
<p>The rest gets bizarre...</p>
<p>The <a class="el" href="class_l_p_d8806.html" title="Class that stores state and functions for interacting with LPD8806 LED strips. ">LPD8806</a> does not perform an in-unison latch (which would display the newly-transmitted data all at once). Rather, each individual byte (even the separate G, R, B components of each LED) is latched AS IT ARRIVES... or more accurately, as the first bit of the subsequent byte arrives and is passed through. So the strip actually refreshes at the speed the data is issued, not instantaneously (this can be observed by greatly reducing the data rate). This has implications for POV displays and light painting applications. The 'subsequent' rule also means that at least one extra byte must follow the last pixel, in order for the final blue LED to latch.</p>
<p>To reset the pass-through behavior and begin sending new data to the start of the strip, a number of zero bytes must be issued (remember, all color data bytes have the high bit set, thus are in the range 128 to 255, so the zero is 'special'). This should be done before each full payload of color values to the strip. Curiously, zero bytes can only travel 32 LEDs down the line before needing backup; the next 32 LEDs require an extra zero byte, and so forth. Longer strips will require progressively more zeros. *(see note below)</p>
<p>In the interest of efficiency, it's possible to combine the former EOD extra latch byte and the latter zero reset...the same data can do double duty, latching the last blue LED while also resetting the strip for the next payload.</p>
<p>So: reset byte(s) of suitable length are issued once at startup to 'prime' the strip to a known ready state. After each subsequent LED color payload, these reset byte(s) are then issued at the END of each payload, both to latch the last LED and to prep the strip for the start of the next payload (even if that data does not arrive immediately). This avoids a tiny bit of latency as the new color payload can begin issuing immediately on some signal, such as a timer or GPIO trigger.</p>
<p>Technically these zero byte(s) are not a latch, as the color data (save for the last byte) is already latched. It's a start-of-data marker, or an indicator to clear the thing-that's-not-a-shift-register. But for conversational consistency with other LED drivers, we'll refer to it as a 'latch' anyway.</p>
<p>This has been validated independently with multiple customers' hardware. Please do not report as a bug or issue pull requests for this. Fewer zeros sometimes gives the <em>illusion</em> of working, the first payload will correctly load and latch, but subsequent frames will drop data at the end. The data shortfall won't always be visually apparent depending on the color data loaded on the prior and subsequent frames. Tested. Confirmed. Fact.</p>
<h1><a class="anchor" id="author"></a>
Author</h1>
<p>Limor Fried (Adafruit Industries)</p>
<h1><a class="anchor" id="copyright"></a>
Copyright</h1>
<p>Copyright (C) Adafruit Industries</p>
<h1><a class="anchor" id="license"></a>
License</h1>
<p>MIT license </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
